<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_player_idle</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-10</depth>
  <persistent>-1</persistent>
  <parentName>obj_health_entity</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

image_speed = 1 / room_speed * 2;

dodgeDistance = 96;

goUp = true;

damage = 25;

lastDirection = 0;

moveSpeed = 3;

dodgeX = x;
dodgeY = y;

alarm[0] = room_speed / 2;

buffed = false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>buffed = false;
damage = 25;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Make stepping sound
if(STATE == WALKING){
    audio_play_sound(snd_step0, 10, false);
}

alarm[0] = room_speed / 2;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Initial Movement code
event_inherited();

hspeed = (keyboard_check(vk_right) - keyboard_check(vk_left)) * moveSpeed;
vspeed = (keyboard_check(vk_down) - keyboard_check(vk_up)) * moveSpeed;

if(STATE != ATTACKING &amp;&amp; STATE != DODGING){
    if(hspeed != 0 || vspeed != 0){
        if(STATE == IDLE)
            alarm[0] = 1;
        STATE = WALKING;
    }else{
        STATE = IDLE;
    }
}else{
    hspeed = 0;
    vspeed = 0;
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Non-Movement Input


if(keyboard_check_pressed(ord('X'))){
    var interact = instance_create(x, y, obj_interact);
    interact.image_angle = direction;
    STATE = IDLE;
    image_index = 1;
}

if(keyboard_check_pressed(ord('A'))){
    if(global.currency[0] - 50 &gt;= 0 &amp;&amp; currHP != maxHP){
        global.currency[0] -= 50;
        currHP = min(maxHP, currHP + 50);
    }
}

if(keyboard_check_pressed(ord('S'))){
    if(global.buffleBerries - 1 &gt;= 0 &amp;&amp; !buffed){
        global.buffleBerries--;
        buffed = true;
        damage = 50;
        alarm[1] = room_speed * 10;
    }
}

if(keyboard_check_pressed(ord('D'))){
    var dirt = instance_place(x, y, obj_dirt);
    if(global.buffleBerrySeeds - 1 &gt;= 0 &amp;&amp; dirt != noone){
        global.buffleBerries--;        
        with(dirt){
            instance_create(dirt.x, dirt.y, obj_loot_bush);
            instance_destroy();
        }
    }
}

if(keyboard_check_pressed(ord('Z')) &amp;&amp; STATE != ATTACKING){
    var attack = instance_create(x, y, obj_attack);
    attack.user = id;
    attack.image_angle = direction;
    attack.damage = damage;
    attack.knockback = 32;
    image_index = 0;
    STATE = ATTACKING;
}

if(keyboard_check_pressed(vk_shift) &amp;&amp; STATE != DODGING){
    STATE = DODGING;
    dodgeX = x + lengthdir_x(dodgeDistance, direction);
    dodgeY = y + lengthdir_y(dodgeDistance, direction);
    audio_play_sound(snd_dodge, 10, false);
    image_index = 0;
}

if(keyboard_check_pressed(ord('H'))){
    if(room != rm_home){
        room_goto(rm_home);
    }
}else if(currHP &lt;= 0){
    room_goto(rm_home);
    currHP = maxHP;
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// State management


if(STATE == IDLE){
    sprite_index = sp_player_idle;
    image_speed = 1 / room_speed * 2;
    
}else if(STATE == WALKING){
    sprite_index = sp_player_walk;
    image_speed = 1 / room_speed * 7;
    
}else if(STATE == ATTACKING){
    sprite_index = sp_player_attack;
    image_speed = 1 / room_speed * 18;
    
    if(image_index &gt;= image_number - 0.5){
        STATE = IDLE;
    }
    
}else if(STATE == DODGING){
    sprite_index = sp_player_dodge;
    image_speed = 1 / room_speed * 24;
    if(point_distance(x, y, dodgeX, dodgeY) &gt; 8){
        invulnerable = true;
        var dir = point_direction(x, y, dodgeX, dodgeY);
        hspeed = lengthdir_x(moveSpeed * 2, dir);
        vspeed = lengthdir_y(moveSpeed * 2, dir);
    }else{
        STATE = IDLE;
        invulnerable = false;
    }
    
    if(place_meeting(x+hspeed, y+vspeed, obj_collidable)){
        STATE = IDLE;
    }
    
}

if(buffed){
    tint = c_blue;
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Update movement and graphics


if (place_meeting(x+hspeed,y,obj_collidable)) hspeed=0;
if (place_meeting(x,y+vspeed,obj_collidable)) vspeed=0;

if(bbox_left + hspeed &lt; 0 || bbox_right + hspeed &gt; room_width)
    hspeed = 0;
    
if(bbox_top + vspeed &lt; 0 || bbox_bottom + vspeed &gt; room_height)
    vspeed = 0;
    
if(hspeed &gt; 0){
    image_xscale = 1;
}else if(hspeed &lt; 0){
    image_xscale = -1;
}

if(hspeed == 0 &amp;&amp; vspeed == 0){
    direction = lastDirection;
}

lastDirection = direction;



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
dodgeX = x;
dodgeY = y;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Save Data

ini_open("saveData.ini");
ini_write_real("Players", "currency0", global.currency[0]);
ini_write_real("Players", "buffleBerries", global.buffleBerries);
ini_write_real("Players", "buffleBerrySeeds", global.buffleBerrySeeds);

if(room == rm_home){
    for(var i = 0; i &lt; 15; i++)
        ini_section_delete("Bush"+string(i));
        
    var count = instance_number(obj_loot_bush);
    for(var i = 0; i &lt; count; i++){
        var bush = instance_find(obj_loot_bush, i);
        ini_write_real("Bush"+string(i), "x", bush.x);
        ini_write_real("Bush"+string(i), "y", bush.y);
        ini_write_real("Bush"+string(i), "isGrown", bush.image_index == 3);
        
    }
}

ini_close();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Load Save Data

ini_open("saveData.ini");
global.currency[0] = ini_read_real("Players","currency0", 0);
global.buffleBerries = ini_read_real("Players","buffleBerries", 1);
global.buffleBerrySeeds = ini_read_real("Players","buffleBerrySeeds", 1);

if(room == rm_home){
    for(var i = 0; i &lt; 15; i++){
        if(ini_section_exists("Bush"+string(i))){
            var xx = ini_read_real("Bush"+string(i),"x", 0);
            var yy = ini_read_real("Bush"+string(i),"y", 0);
            var isGrown = ini_read_real("Bush"+string(i),"isGrown", false);
            var bush = instance_create(xx, yy, obj_loot_bush);
            if(isGrown){
                bush.image_index = 2;
                bush.alarm[0] = 1;
            }
        }
    }
}

ini_close();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
var hpPercent = currHP / maxHP;

// Draw health loss
draw_sprite_part_ext(sp_player_health, 0,
                     sprite_get_width(sp_player_health) * hpPercent, 0,
                     sprite_get_width(sp_player_health) * (1.0 - hpPercent), sprite_get_height(sp_player_health),
                     20 + sprite_get_width(sp_player_health) * hpPercent * 2, 20,
                     2, 2,
                     c_white, 1
                    );
// Draw Remaining Health
draw_sprite_part_ext(sp_player_health, 1,
                     0, 0,
                     sprite_get_width(sp_player_health) * hpPercent + 1, sprite_get_height(sp_player_health),
                     20, 20,
                     2, 2,
                     c_white, 1
                     );
                     
                     
// Draw the join
var joinIndex = currHP % 12 div 4;
var joinStart = 0;
if(sprite_get_width(sp_player_health) * hpPercent * 2 &lt; sprite_get_width(sp_player_health_join)*2){
    joinStart = sprite_get_width(sp_player_health_join)*2 - sprite_get_width(sp_player_health) * hpPercent;
}
var joinEnd = sprite_get_width(sp_player_health_join);
if(sprite_get_width(sp_player_health) * hpPercent + sprite_get_width(sp_player_health_join) / 2 &gt; sprite_get_width(sp_player_health) - 8){
    joinEnd = -(sprite_get_width(sp_player_health) * hpPercent + sprite_get_width(sp_player_health_join) / 2 - (sprite_get_width(sp_player_health) - 8));
}
draw_sprite_part_ext(sp_player_health_join, joinIndex,
                     joinStart, 0,
                     joinEnd, sprite_get_height(sp_player_health),
                     20 + sprite_get_width(sp_player_health) * hpPercent * 2 - sprite_get_width(sp_player_health_join), 20,
                     2, 2,
                     c_white, 1
                     );
               

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw Controls

draw_set_colour(c_black);
draw_set_halign(fa_left);
draw_text(0, (view_hport * 0.92) div 1, "Attack: Z");
draw_text(0, (view_hport * 0.94) div 1, "Use: X");
draw_text(0, (view_hport * 0.96) div 1, "Dodge: SHIFT");
draw_text(0, (view_hport * 0.98) div 1, "Movement: Arrow Keys");
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
